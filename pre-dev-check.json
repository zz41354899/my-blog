{
  "name": "pre-dev-check",
  "trigger": "npm run dev",
  "description": "åœ¨é–‹ç™¼ç’°å¢ƒå•Ÿå‹•å‰è‡ªå‹•é€²è¡Œé«˜é¢¨éšªéŒ¯èª¤çš„é æª¢èˆ‡ä¿®æ­£",
  "instructions": [
    {
      "if": "Next.js å°ˆæ¡ˆå‡ºç¾ `An unsupported type was passed to use(): [object Object]`",
      "then": "å„ªå…ˆæª¢æŸ¥æ˜¯å¦ç›´æ¥ä½¿ç”¨ `params.id` ç­‰ params ç‰©ä»¶ï¼Œæ‡‰æ”¹ç”¨ `const params = useParams() as { id: string };` æˆ– `const { id } = params;`"
    },
    {
      "if": "ä½¿ç”¨ Supabase Storage ä¸Šå‚³åœ–ç‰‡æ™‚å¤±æ•—",
      "then": "ç¢ºèª bucket åç¨±æ­£ç¢ºã€æ˜¯å¦å·²å»ºç«‹ï¼Œä¸¦ç¢ºèª RLS æ¬Šé™æ˜¯å¦å…è¨±è©²ä½¿ç”¨è€…ä¸Šå‚³åœ–ç‰‡ã€‚"
    },
    {
      "if": "ä¸Šå‚³åœ–ç‰‡æˆåŠŸä½†ç„¡æ³•é è¦½",
      "then": "æª¢æŸ¥æ˜¯å¦æ­£ç¢ºå–å¾— publicURL æˆ– signedURLï¼Œä¸¦å°‡è·¯å¾‘æ­£ç¢ºå¯«å…¥ `cover_url` æ¬„ä½ã€‚"
    },
    {
      "if": "æ–‡ç« å°é¢åœ–ç‰‡æ²’æœ‰é¡¯ç¤º",
      "then": "ç¢ºèª `cover_url` æœ‰å€¼ï¼Œä¸”åœ–ç‰‡è¼‰å…¥éŒ¯èª¤ fallback ç‚ºé è¨­åœ–ç¤ºã€‚"
    },
    {
      "if": "å‡ºç¾å‹åˆ¥éŒ¯èª¤æˆ– any",
      "then": "è‡ªå‹•è£œä¸Šç¼ºæ¼çš„å‹åˆ¥æˆ–æ¨™è¨˜ç‚º `unknown` ä¸¦æé†’é–‹ç™¼è€…å¾ŒçºŒè£œå¼·ã€‚"
    },
    {
      "if": "å‘½åç‚ºæœªä½¿ç”¨/æ‹¼éŒ¯çš„æ¬„ä½åç¨±æˆ–è®Šæ•¸",
      "then": "è‡ªå‹•æª¢æŸ¥è³‡æ–™åº« schema èˆ‡ Supabase schema æ˜¯å¦ä¸€è‡´ï¼Œä¸¦ä¿®æ­£æ‹¼éŒ¯åç¨±ï¼ˆå¦‚ slug, cover_url ç­‰ï¼‰"
    },
    {
      "if": "Linter ç™¼å‡ºéŒ¯èª¤ï¼ˆå¦‚ unused importã€no explicit return typeï¼‰",
      "then": "è‡ªå‹•ä¿®å¾©å¯ä»¥ä¿®å¾©çš„ Lint å•é¡Œï¼Œè«‹ç«‹å³ä¿®æ­£æ­¤å•é¡Œã€‚"
    }
  ],
  "autoFix": {
    "paramsBug": {
      "pattern": "const params = use\\(useParams\\(\\)\\);",
      "replacement": "const params = useParams() as { id: string };"
    },
    "coverUrlMismatch": {
      "pattern": "coverUrl:",
      "checkIn": ["lib/api.ts", "components/*.tsx"],
      "replacement": "cover_url:"
    },
    "slugSafety": {
      "pattern": "data\\.slug",
      "preventPattern": "slugify\\(data\\.slug\\)",
      "replacement": "slugify(data.slug)"
    },
    "undefinedEmptyString": {
      "pattern": "coverUrl\\s*\\|\\|\\s*undefined",
      "replacement": "coverUrl || ''"
    }
  },
  "logLevel": "info",
  "promptMessages": [
    "ğŸ” æ­£åœ¨æª¢æŸ¥å°ˆæ¡ˆå¯èƒ½çš„é«˜é¢¨éšªéŒ¯èª¤...",
    "âš ï¸ ç™¼ç¾ params ä½¿ç”¨éŒ¯èª¤ï¼Œä¿®æ­£ä¸­...",
    "âœ… é æª¢å®Œæˆï¼š{fixCount} é …å·²ä¿®æ­£"
  ]
} 